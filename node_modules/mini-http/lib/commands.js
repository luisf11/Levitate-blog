/*

# all mini-http commands

// NOTE: To add new commands follow the pattern

*/

'use strict';

var fs             = require('fs');
var defConfigs     = require('./configs.js');
var app            = require('./index.js');


var commands = [
  {
    command: [
      "-p=",
      "--port="
    ],
    info: "to set server port",
    exec: function (config, option) {
      config.port = option;
    }
  },
  {
    command: [
      "-sh=",
      "--slash="
    ],
    info: "to set server home page",
    exec: function (config, option) {
      config.slash = option;
    }
  },
  {
    command: [
      "-r=",
      "--root="
    ],
    info: "to set server root path",
    exec: function (config, option) {
      // TODO: make user able to set root route for his server
      // config.root = option;
      console.log("\nSorry!!, changing root path for mini-http is not supported currently");
      process.exit();
    }
  },
  {
    command: [
      "-ss=",
      "--success="
    ],
    info: "Starting message if server started successfully",
    exec: function (config, option) {
      config.startingMsg = option;
    }
  },
  {
    command: [
      "-l",
      "--log"
    ],
    info: "to log server configs",
    exec: function (config, option) {
      config.log = true;
    }
  },
  {
    command: [
      "-h",
      "--help"
    ],
    info: "for help",
    exec: function (config, option) {
      config.help = true;

      console.log("\n");
      for (var i = 0; i < commands.length; i++) { console.log("\n"+ commands[i].info + "\n", commands[i].command); }
      console.log('\n to run server on port 8000 write: " mini-http -p=8000 "');

      process.exit();
    }
  },
  {
    command: [
      "init",
      "-i"
    ],
    info: "to create a mini-http.json file in your project and make a custom server for it.",
    exec: function (config, option) {

      app.init(config, option);

      config.start = false;
    }
  },
  {
    command: [
      "--def",
      "--set"
    ],
    info: "to set default configs",
    exec: function (config, option) {
      var server = {}, custom = "";
      server = defConfigs.set(server, config);

      custom += "{\n";
      custom += "\"port\": "+ server.port + ",\n";
      custom += "\"startingMsg\": \""+ server.startingMsg + "\",\n";
      if (server.slash) custom += "\"slash\": \""+ server.slash + "\",\n";
      else custom += "\"slash\": "+ server.slash + ",\n";
      custom += "\"log\": "+ server.log + "\n";
      custom += "}";

      fs.writeFileSync(__dirname+"/mini-http.json", custom);
      process.exit();
    }
  }
];

module.exports = commands;
